<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>√Ålbum Familiar</title>

<style>
body {
  font-family: Arial, sans-serif;
  background: #f5f5f5;
  margin: 0;
  padding: 20px;
}

/* ---- GRID RESPONSIVE ---- */
.gallery {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
  gap: 14px;
  margin-top: 25px;
}
.gallery figure {
  background: #fff;
  border-radius: 12px;
  overflow: hidden;
  box-shadow: 0 2px 5px #0002;
  margin: 0;
}
.gallery img {
  width: 100%;
  height: 150px;
  object-fit: cover;
}
.gallery figcaption {
  padding: 8px;
  font-size: 13px;
  color: #555;
  text-overflow: ellipsis;
  white-space: nowrap;
  overflow: hidden;
}

/* ---- DRAG & DROP ---- */
.dropzone {
  border: 2px dashed #bbb;
  border-radius: 14px;
  padding: 35px;
  text-align: center;
  transition: background 0.2s;
  cursor: pointer;
  background: #fafafa;
  margin-bottom: 20px;
}
.dropzone.dragover {
  background: #e8f5ff;
  border-color: #2196f3;
}

/* ---- PREVIEWS ---- */
.preview-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(130px, 1fr));
  gap: 12px;
  margin-top: 15px;
}
.preview {
  position: relative;
}
.preview img {
  width: 100%;
  height: 130px;
  object-fit: cover;
  border-radius: 10px;
}
.preview button {
  position: absolute;
  top: 5px;
  right: 5px;
  background: #fff;
  border: none;
  border-radius: 50%;
  padding: 4px 8px;
  cursor: pointer;
}
</style>
</head>

<body>

<h1>üì∏ √Ålbum Familiar</h1>
<p>Galer√≠a autom√°tica desde <code>/imagenes/Fotos</code> del repositorio.</p>

<!-- DRAG & DROP -->
<div id="dropzone" class="dropzone">
  Arrastra im√°genes aqu√≠ o haz clic para seleccionar.
</div>

<input id="fileInput" type="file" accept="image/*" multiple style="display:none" />

<div id="previewContainer" class="preview-grid"></div>

<hr />

<h2>Galer√≠a</h2>
<div id="gallery" class="gallery"></div>

<script>
const repoOwner = "KATO250712";
const repoName  = "AlbumFamiliar";
const repoPath  = "imagenes/Fotos";
const branch    = "main";

const gallery = document.getElementById("gallery");
const dropzone = document.getElementById("dropzone");
const fileInput = document.getElementById("fileInput");
const previewContainer = document.getElementById("previewContainer");

/* ------------ CARGAR LISTA DEL REPO  ------------ */
async function loadGallery() {
  const url = `https://api.github.com/repos/${repoOwner}/${repoName}/contents/${repoPath}?ref=${branch}`;
  const res = await fetch(url);
  const data = await res.json();

  gallery.innerHTML = "";

  data
    .filter(f => /\.(png|jpg|jpeg|gif|webp)$/i.test(f.name))
    .reverse()
    .forEach(f => {
      const fig = document.createElement("figure");
      fig.innerHTML = `
        <img src="${f.download_url}" />
        <figcaption>${f.name}</figcaption>
      `;
      gallery.appendChild(fig);
    });
}

loadGallery();

/* ------------ DRAG & DROP + PREVIEW ------------ */
dropzone.onclick = () => fileInput.click();

dropzone.addEventListener("dragover", e => {
  e.preventDefault();
  dropzone.classList.add("dragover");
});
dropzone.addEventListener("dragleave", () =>
  dropzone.classList.remove("dragover")
);
dropzone.addEventListener("drop", e => {
  e.preventDefault();
  dropzone.classList.remove("dragover");
  const files = Array.from(e.dataTransfer.files);
  showPreviews(files);
});

fileInput.onchange = e => {
  const files = Array.from(e.target.files);
  showPreviews(files);
};

function showPreviews(files) {
  files.forEach(file => {
    const url = URL.createObjectURL(file);
    const div = document.createElement("div");
    div.className = "preview";
    div.innerHTML = `
      <img src="${url}" />
      <button onclick="this.parentElement.remove()">‚úï</button>
    `;
    previewContainer.appendChild(div);
  });
}
</script>

</body>
</html>
