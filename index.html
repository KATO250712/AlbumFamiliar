<!-- ======================= -->
<!--   GALER√çAS DIN√ÅMICAS    -->
<!-- ======================= -->

<style>
  .galeria-section {
    margin: 30px auto;
    max-width: 1200px;
    padding: 10px;
  }
  .galeria-section h2 {
    text-align: center;
    margin-bottom: 15px;
    font-size: 1.8rem;
  }
  .grid-media {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
    gap: 12px;
  }
  .grid-media img, 
  .grid-media video {
    width: 100%;
    height: 150px;
    object-fit: cover;
    border-radius: 10px;
    cursor: pointer;
    transition: 0.3s ease;
  }
  .grid-media img:hover,
  .grid-media video:hover {
    transform: scale(1.05);
  }
  /* Lightbox */
  #lightboxX {
    position: fixed;
    inset: 0;
    background: rgba(0,0,0,0.85);
    display: none;
    justify-content: center;
    align-items: center;
    z-index: 999;
    padding: 20px;
  }
  #lightboxX img,
  #lightboxX video {
    max-width: 90%;
    max-height: 85%;
    border-radius: 15px;
  }
  #closeLB {
    position: absolute;
    top: 20px;
    right: 35px;
    color: white;
    font-size: 40px;
    cursor: pointer;
  }
</style>

<div id="lightboxX">
  <span id="closeLB">&times;</span>
  <div id="lb-content"></div>
</div>

<script>
async function getFiles(folder) {
  try {
    const api = `https://api.github.com/repos/KATO250712/AlbumFamiliar/contents/${folder}`;
    const res = await fetch(api);
    if (!res.ok) return [];
    return await res.json();
  } catch (e) {
    return [];
  }
}

function renderGallery(containerId, files, type) {
  const box = document.getElementById(containerId);
  if (!box) return;

  let html = "";
  files.forEach(f => {
    const url = f.download_url;

    if (type === "img" && /\.(jpg|jpeg|png|gif|webp)$/i.test(f.name)) {
      html += `<img src="${url}" onclick="openLB('img','${url}')">`;
    }

    if (type === "video" && /\.(mp4|mov|webm)$/i.test(f.name)) {
      html += `<video src="${url}" muted loop onclick="openLB('video','${url}')"></video>`;
    }
  });

  box.innerHTML = html;
}

function openLB(type, src) {
  const lb = document.getElementById("lightboxX");
  const cont = document.getElementById("lb-content");

  cont.innerHTML = (type === "img")
    ? `<img src="${src}">`
    : `<video src="${src}" controls autoplay></video>`;

  lb.style.display = "flex";
}
document.getElementById("closeLB").onclick = () => {
  document.getElementById("lightboxX").style.display = "none";
};

async function loadGalleries() {
  const fotos = await getFiles("fotos");
  const videos = await getFiles("videos");
  const imagenes = await getFiles("imagenes");

  renderGallery("galeriaFotos", fotos, "img");
  renderGallery("galeriaVideos", videos, "video");
  renderGallery("galeriaImagenes", imagenes, "img");
}
loadGalleries();
</script>

<!-- ======================= -->
<!--         SECCIONES       -->
<!-- ======================= -->

<div class="galeria-section">
  <h2>üì∑ Galer√≠a de Fotos</h2>
  <div id="galeriaFotos" class="grid-media"></div>
</div>

<div class="galeria-section">
  <h2>üé• Galer√≠a de Videos</h2>
  <div id="galeriaVideos" class="grid-media"></div>
</div>

<div class="galeria-section">
  <h2>üñºÔ∏è Galer√≠a Im√°genes (Carpeta imagenes/)</h2>
  <div id="galeriaImagenes" class="grid-media"></div>
</div>
